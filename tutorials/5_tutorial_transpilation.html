<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Braket-native primitives" href="6_tutorial_primitives.html" /><link rel="prev" title="Native Programming" href="4_tutorial_native_programming.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.01.29 -->
        <title>Transpiling circuits and programs to Braket - Qiskit-Braket provider 0.9.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-sphinx-theme.css?v=fe84956c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-ecosystem.css?v=745c5aa7" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
<script src="../_static/js/web-components/top-nav-bar.js"></script></head>
  <body>
    
    <script>document.body.dataset.theme = "light";</script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <path d="M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4ZM4,6H20V26H4ZM28,26H22V6h6Z"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <rect x="4" y="6" width="24" height="2"/>
      <rect x="4" y="24" width="24" height="2"/>
      <rect x="4" y="12" width="24" height="2"/>
      <rect x="4" y="18" width="24" height="2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg version="1.1" id="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
         viewBox="0 0 32 32" style="enable-background:new 0 0 32 32;" xml:space="preserve"><polygon points="22,16 12,26 10.6,24.6 19.2,16 10.6,7.4 12,6 " stroke="currentColor"/>
      <rect id="_x3C_Transparent_Rectangle_x3E_" fill="none" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-new-tab" viewBox="0 0 32 32">
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
      <defs>
        <style>
          .cls-1 {
            fill: none;
          }
        </style>
      </defs>
      <path fill="#6929C4" d="M26,28H6a2.0027,2.0027,0,0,1-2-2V6A2.0027,2.0027,0,0,1,6,4H16V6H6V26H26V16h2V26A2.0027,2.0027,0,0,1,26,28Z"/>
      <polygon fill="#6929C4" points="20 2 20 4 26.586 4 18 12.586 19.414 14 28 5.414 28 12 30 12 30 2 20 2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Qiskit-Braket provider 0.9.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky">
<a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Qiskit-Braket provider 0.9.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/index.html">API References</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API References</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/providers.html">Provider module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_braket_provider.providers</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Provider module (qiskit_braket_provider.providers)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_braket_provider.providers.BraketAwsBackend.html">qiskit_braket_provider.providers.BraketAwsBackend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_braket_provider.providers.BraketEstimator.html">qiskit_braket_provider.providers.BraketEstimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_braket_provider.providers.BraketLocalBackend.html">qiskit_braket_provider.providers.BraketLocalBackend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_braket_provider.providers.BraketProvider.html">qiskit_braket_provider.providers.BraketProvider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_braket_provider.providers.BraketQuantumTask.html">qiskit_braket_provider.providers.BraketQuantumTask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_braket_provider.providers.BraketSampler.html">qiskit_braket_provider.providers.BraketSampler</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how_tos/0_how_to_access_AWS_Braket_devices.html">How-to: access AWS Braket devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_tos/1_how_to_run_circuits_on_Braket_devices.html">How-to: run circuit on Braket devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_tos/2_how_to_retrieve_results_from_backend.html">How-to: retrieve results from backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_tos/3_how_to_qiskit_hybrid_job.html">How-to: Qiskit Hybrid Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_tos/4_how_to_verbatim_circuits.html">How-to: run circuit on Braket device using verbatim mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how_tos/5_how_to_run_circuits_on_Braket_local_backend.html">How-to: run circuit on Braket local backend</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="0_tutorial_qiskit-braket-provider_overview.html">Getting started with the Qiskit-Braket provider</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_tutorial_vqe.html">Running VQE on an Amazon Braket backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_tutorial_hybrid_jobs.html">Running variational quantum algorithms with Amazon Braket Hybrid Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_tutorial_minimum_eigen_optimizer.html">Minimum Eigen Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_tutorial_native_programming.html">Native Programming</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Transpiling circuits and programs to Braket</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_tutorial_primitives.html">Braket-native primitives</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Transpiling-circuits-and-programs-to-Braket">
<h1>Transpiling circuits and programs to Braket<a class="headerlink" href="#Transpiling-circuits-and-programs-to-Braket" title="Link to this heading">¶</a></h1>
<p>In this notebook, we will learn how to use the Qiskit-Braket provider to transpile arbitrary programs of multiple different formats to QPU-native Braket circuits.</p>
<p>We begin by importing all required classes and functions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.transpiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">PassManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.transpiler.passes</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Collect2qBlocks</span><span class="p">,</span>
    <span class="n">ConsolidateBlocks</span><span class="p">,</span>
    <span class="n">UnitarySynthesis</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">braket.circuits</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">braket.circuits.serialization</span><span class="w"> </span><span class="kn">import</span> <span class="n">IRType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">braket.devices</span><span class="w"> </span><span class="kn">import</span> <span class="n">Devices</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">braket.ir.openqasm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Program</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_braket_provider</span><span class="w"> </span><span class="kn">import</span> <span class="n">BraketAwsBackend</span><span class="p">,</span> <span class="n">to_braket</span>
</pre></div>
</div>
</div>
<section id="Transpiling-Qiskit-circuits">
<h2>Transpiling Qiskit circuits<a class="headerlink" href="#Transpiling-Qiskit-circuits" title="Link to this heading">¶</a></h2>
<p>Let’s begin by looking at a simple Qiskit circuit, a four-qubit GHZ state.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ghz_qiskit</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuantumCircuit</span><span class="p">:</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">qc</span>


<span class="n">qc</span> <span class="o">=</span> <span class="n">ghz_qiskit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        ┌───┐                ░ ┌─┐
   q_0: ┤ H ├──■─────────────░─┤M├─────────
        └───┘┌─┴─┐           ░ └╥┘┌─┐
   q_1: ─────┤ X ├──■────────░──╫─┤M├──────
             └───┘┌─┴─┐      ░  ║ └╥┘┌─┐
   q_2: ──────────┤ X ├──■───░──╫──╫─┤M├───
                  └───┘┌─┴─┐ ░  ║  ║ └╥┘┌─┐
   q_3: ───────────────┤ X ├─░──╫──╫──╫─┤M├
                       └───┘ ░  ║  ║  ║ └╥┘
   c: 4/════════════════════════╬══╬══╬══╬═
                                ║  ║  ║  ║
meas: 4/════════════════════════╩══╩══╩══╩═
                                0  1  2  3
</pre></div></div>
</div>
<p>We can call <code class="docutils literal notranslate"><span class="pre">to_braket</span></code> to convert this circuit to a Braket circuit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">qc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T  : │  0  │  1  │  2  │  3  │  4  │
      ┌───┐                   ┌───┐
q0 : ─┤ H ├───●───────────────┤ M ├─
      └───┘   │               └───┘
            ┌─┴─┐             ┌───┐
q1 : ───────┤ X ├───●─────────┤ M ├─
            └───┘   │         └───┘
                  ┌─┴─┐       ┌───┐
q2 : ─────────────┤ X ├───●───┤ M ├─
                  └───┘   │   └───┘
                        ┌─┴─┐ ┌───┐
q3 : ───────────────────┤ X ├─┤ M ├─
                        └───┘ └───┘
T  : │  0  │  1  │  2  │  3  │  4  │
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:859: UserWarning: The Qiskit circuit contains barrier instructions that are ignored.
  warnings.warn(&#34;The Qiskit circuit contains barrier instructions that are ignored.&#34;)
</pre></div></div>
</div>
<p>If we run this circuit on a Braket QPU directly, it’ll be compiled to the device’s native gateset and topology. If we want to do this compilation client-side before sending the circuit to the service, we can pass a few extra parameters to <code class="docutils literal notranslate"><span class="pre">to_braket</span></code> to get a compatible native circuit.</p>
<p>First, we can pass a backend’s target to get a circuit with native gates and connectivity. Let’s use IQM’s Emerald device.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="n">BraketAwsBackend</span><span class="p">(</span><span class="n">Devices</span><span class="o">.</span><span class="n">IQM</span><span class="o">.</span><span class="n">Emerald</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">target</span>
<span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T  : │        0        │         1         │         2         │         3         │         4         │         5         │         6         │            7            │         8         │  9  │        10         │ 11  │        12         │ 13  │        14         │ 15  │        16         │ 17  │ 18  │        19         │        20         │ 21  │        22         │        23         │      24       │ 25  │
                        ┌─────────────────┐ ┌─────────────────┐                                                                                                                                                                                                                                                                                                                                                         ┌───┐
q0 : ───StartVerbatim───┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├──────────●────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────EndVerbatim───┤ M ├─
              ║         └─────────────────┘ └─────────────────┘          │                                                                                                                                                                                                                                                                                                                                     ║        └───┘
              ║         ┌─────────────────┐ ┌─────────────────┐        ┌─┴─┐        ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐                     ┌───┐ ┌─────────────────┐ ┌───┐ ┌─────────────────┐ ┌───┐                                                                                                                                                                                  ║
q1 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├─┤ PRx(1.57, 0.00) ├─────────────────────┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────║──────────────
              ║         └─────────────────┘ └─────────────────┘        └───┘        └─────────────────┘ └─────────────────┘ └─────────────────┘                     └─┬─┘ └─────────────────┘ └─┬─┘ └─────────────────┘ └─┬─┘                                                                                                                                                                                  ║
              ║         ┌─────────────────┐        ┌───┐        ┌─────────────────┐        ┌───┐        ┌─────────────────┐        ┌───┐        ┌─────────────────┐   │   ┌─────────────────┐   │                         │                                                                                                                               ┌───┐ ┌─────────────────┐ ┌─────────────────┐        ║        ┌───┐
q2 : ─────────║─────────┤ PRx(1.57, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 1.57) ├───┼───┤ PRx(3.14, 0.00) ├───┼─────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├────────║────────┤ M ├─
              ║         └─────────────────┘        └─┬─┘        └─────────────────┘        └─┬─┘        └─────────────────┘        └─┬─┘        └─────────────────┘   │   └─────────────────┘   │                         │                                                                                                                               └─┬─┘ └─────────────────┘ └─────────────────┘        ║        └───┘
              ║         ┌─────────────────┐          │          ┌─────────────────┐          │          ┌─────────────────┐          │          ┌─────────────────┐   │   ┌─────────────────┐   │                         │                                                                                 ┌───┐ ┌─────────────────┐ ┌─────────────────┐   │                                                  ║        ┌───┐
q3 : ─────────║─────────┤ PRx(1.57, 0.00) ├──────────●──────────┤ PRx(1.57, 0.00) ├──────────●──────────┤ PRx(1.57, 0.00) ├──────────●──────────┤ PRx(1.57, 1.57) ├───┼───┤ PRx(3.14, 0.00) ├───┼─────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●──────────────────────────────────────────────────║────────┤ M ├─
              ║         └─────────────────┘                     └─────────────────┘                     └─────────────────┘                     └─────────────────┘   │   └─────────────────┘   │                         │                                                                                 └─┬─┘ └─────────────────┘ └─────────────────┘                                                      ║        └───┘
              ║         ┌─────────────────┐                                                                                                                           │                         │                         │                             ┌─────────────────┐       ┌─────────────────┐         │                                                                                                ║        ┌───┐
q4 : ─────────║─────────┤ PRx(1.57, 0.00) ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼─────────────────────────┼─────────────────────────┼─────────────────────────●───┤ PRx(1.57, 0.00) ├───●───┤ PRx(1.57, 0.00) ├───●─────●────────────────────────────────────────────────────────────────────────────────────────────────║────────┤ M ├─
              ║         └─────────────────┘                                                                                                                           │                         │                         │                         │   └─────────────────┘   │   └─────────────────┘   │                                                                                                      ║        └───┘
              ║         ┌─────────────────┐                                                                                                                           │   ┌─────────────────┐   │   ┌─────────────────┐   │   ┌─────────────────┐ ┌─┴─┐ ┌─────────────────┐ ┌─┴─┐ ┌─────────────────┐ ┌─┴─┐                                                                                                    ║
q5 : ─────────╨─────────┤ PRx(1.57, 0.00) ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────●───┤ PRx(1.57, 0.00) ├───●───┤ PRx(1.57, 0.00) ├───●───┤ PRx(1.57, 0.00) ├─┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├────────────────────────────────────────────────────────────────────────────────────────────────────╨──────────────
                        └─────────────────┘                                                                                                                               └─────────────────┘       └─────────────────┘       └─────────────────┘ └───┘ └─────────────────┘ └───┘ └─────────────────┘ └───┘
T  : │        0        │         1         │         2         │         3         │         4         │         5         │         6         │            7            │         8         │  9  │        10         │ 11  │        12         │ 13  │        14         │ 15  │        16         │ 17  │ 18  │        19         │        20         │ 21  │        22         │        23         │      24       │ 25  │
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:909: UserWarning: Device does not support global phase; global phase of 1.5707963267948966 will not be included in Braket circuit
  warnings.warn(
</pre></div></div>
</div>
<p>We see that the circuit now only uses PRx and CZ gates, and is wrapped in a <a class="reference external" href="https://github.com/amazon-braket/amazon-braket-examples/blob/main/examples/braket_features/Verbatim_Compilation.ipynb">verbatim box</a> to ensure that it isn’t further modified before it runs on the device. However, there’s a problem: the circuit uses qubit 0, does not exist on Emerald! This is because Qiskit expects all qubits to be have contiguous, 0-indexed labels. To get a circuit with the correct qubit labels, we
must also pass in the backend’s <code class="docutils literal notranslate"><span class="pre">qubit_labels</span></code> property.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qubit_labels</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">qubit_labels</span>
<span class="n">braket_circuit</span> <span class="o">=</span> <span class="n">to_braket</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">qubit_labels</span><span class="o">=</span><span class="n">qubit_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">braket_circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T  : │        0        │         1         │         2         │         3         │         4         │         5         │         6         │            7            │         8         │  9  │        10         │ 11  │        12         │ 13  │        14         │ 15  │        16         │ 17  │ 18  │        19         │        20         │ 21  │        22         │        23         │      24       │ 25  │
                        ┌─────────────────┐ ┌─────────────────┐                                                                                                                                                                                                                                                                                                                                                         ┌───┐
q1 : ───StartVerbatim───┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├──────────●────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────EndVerbatim───┤ M ├─
              ║         └─────────────────┘ └─────────────────┘          │                                                                                                                                                                                                                                                                                                                                     ║        └───┘
              ║         ┌─────────────────┐ ┌─────────────────┐        ┌─┴─┐        ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐                     ┌───┐ ┌─────────────────┐ ┌───┐ ┌─────────────────┐ ┌───┐                                                                                                                                                                                  ║
q2 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├─┤ PRx(1.57, 0.00) ├─────────────────────┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────║──────────────
              ║         └─────────────────┘ └─────────────────┘        └───┘        └─────────────────┘ └─────────────────┘ └─────────────────┘                     └─┬─┘ └─────────────────┘ └─┬─┘ └─────────────────┘ └─┬─┘                                                                                                                                                                                  ║
              ║         ┌─────────────────┐        ┌───┐        ┌─────────────────┐        ┌───┐        ┌─────────────────┐        ┌───┐        ┌─────────────────┐   │   ┌─────────────────┐   │                         │                                                                                                                               ┌───┐ ┌─────────────────┐ ┌─────────────────┐        ║        ┌───┐
q3 : ─────────║─────────┤ PRx(1.57, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 0.00) ├────────┤ Z ├────────┤ PRx(1.57, 1.57) ├───┼───┤ PRx(3.14, 0.00) ├───┼─────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├────────║────────┤ M ├─
              ║         └─────────────────┘        └─┬─┘        └─────────────────┘        └─┬─┘        └─────────────────┘        └─┬─┘        └─────────────────┘   │   └─────────────────┘   │                         │                                                                                                                               └─┬─┘ └─────────────────┘ └─────────────────┘        ║        └───┘
              ║         ┌─────────────────┐          │          ┌─────────────────┐          │          ┌─────────────────┐          │          ┌─────────────────┐   │   ┌─────────────────┐   │                         │                                                                                 ┌───┐ ┌─────────────────┐ ┌─────────────────┐   │                                                  ║        ┌───┐
q4 : ─────────║─────────┤ PRx(1.57, 0.00) ├──────────●──────────┤ PRx(1.57, 0.00) ├──────────●──────────┤ PRx(1.57, 0.00) ├──────────●──────────┤ PRx(1.57, 1.57) ├───┼───┤ PRx(3.14, 0.00) ├───┼─────────────────────────┼─────────────────────────────────────────────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●──────────────────────────────────────────────────║────────┤ M ├─
              ║         └─────────────────┘                     └─────────────────┘                     └─────────────────┘                     └─────────────────┘   │   └─────────────────┘   │                         │                                                                                 └─┬─┘ └─────────────────┘ └─────────────────┘                                                      ║        └───┘
              ║         ┌─────────────────┐                                                                                                                           │                         │                         │                             ┌─────────────────┐       ┌─────────────────┐         │                                                                                                ║        ┌───┐
q5 : ─────────║─────────┤ PRx(1.57, 0.00) ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼─────────────────────────┼─────────────────────────┼─────────────────────────●───┤ PRx(1.57, 0.00) ├───●───┤ PRx(1.57, 0.00) ├───●─────●────────────────────────────────────────────────────────────────────────────────────────────────║────────┤ M ├─
              ║         └─────────────────┘                                                                                                                           │                         │                         │                         │   └─────────────────┘   │   └─────────────────┘   │                                                                                                      ║        └───┘
              ║         ┌─────────────────┐                                                                                                                           │   ┌─────────────────┐   │   ┌─────────────────┐   │   ┌─────────────────┐ ┌─┴─┐ ┌─────────────────┐ ┌─┴─┐ ┌─────────────────┐ ┌─┴─┐                                                                                                    ║
q6 : ─────────╨─────────┤ PRx(1.57, 0.00) ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────●───┤ PRx(1.57, 0.00) ├───●───┤ PRx(1.57, 0.00) ├───●───┤ PRx(1.57, 0.00) ├─┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├────────────────────────────────────────────────────────────────────────────────────────────────────╨──────────────
                        └─────────────────┘                                                                                                                               └─────────────────┘       └─────────────────┘       └─────────────────┘ └───┘ └─────────────────┘ └───┘ └─────────────────┘ └───┘
T  : │        0        │         1         │         2         │         3         │         4         │         5         │         6         │            7            │         8         │  9  │        10         │ 11  │        12         │ 13  │        14         │ 15  │        16         │ 17  │ 18  │        19         │        20         │ 21  │        22         │        23         │      24       │ 25  │
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:859: UserWarning: The Qiskit circuit contains barrier instructions that are ignored.
  warnings.warn(&#34;The Qiskit circuit contains barrier instructions that are ignored.&#34;)
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:909: UserWarning: Device does not support global phase; global phase of 1.5707963267948966 will not be included in Braket circuit
  warnings.warn(
</pre></div></div>
</div>
<p>Now the circuit’s qubits all exist on Emerald. There’s one more unusual thing about the circuit though, and it’s that it uses more qubits than the original GHZ state. This is because the requested qubits (namely 1, 2, 3, and 4) are not all directly connected, and we need to use ancilla qubits and swaps to ensure 2q gates are applied correctly.</p>
<p>Note: this circuit may have a different number of qubits from the previous one; this is because the Qiskit transpiler is nondeterministic, and may route the circuit differently each time it’s called.</p>
<p>We can confirm that we only measure four qubits:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">braket_circuit</span><span class="o">.</span><span class="n">_measure_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Qubit(1), Qubit(5), Qubit(4), Qubit(3)]
</pre></div></div>
</div>
<p>In addition to not being connected, the qubits we’ve chosen are not necessarily going to be of the highest quality. If we want to use better qubits, or at least minimize the number of extra qubits, we can pass in an <a class="reference external" href="https://quantum.cloud.ibm.com/docs/en/guides/set-optimization">optimization level</a> (default 0) that routes the circuit to higher-quality qubits with the best connectivity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">qubit_labels</span><span class="o">=</span><span class="n">qubit_labels</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T   : │        0        │         1         │         2         │  3  │         4         │         5         │  6  │         7         │         8         │  9  │        10         │        11         │      12       │ 13  │
                         ┌─────────────────┐ ┌─────────────────┐ ┌───┐ ┌─────────────────┐ ┌─────────────────┐                                                                                                             ┌───┐
q15 : ───StartVerbatim───┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├─┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●───────────────────────────────────────────────────────────────────────────────────────────EndVerbatim───┤ M ├─
               ║         └─────────────────┘ └─────────────────┘ └─┬─┘ └─────────────────┘ └─────────────────┘   │                                                                                                ║        └───┘
               ║         ┌─────────────────┐ ┌─────────────────┐   │                                           ┌─┴─┐ ┌─────────────────┐ ┌─────────────────┐                                                      ║        ┌───┐
q16 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───┼───────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●──────────────────────────────────────────────────║────────┤ M ├─
               ║         └─────────────────┘ └─────────────────┘   │                                           └───┘ └─────────────────┘ └─────────────────┘   │                                                  ║        └───┘
               ║         ┌─────────────────┐ ┌─────────────────┐   │                                                                                         ┌─┴─┐ ┌─────────────────┐ ┌─────────────────┐        ║        ┌───┐
q17 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───┼─────────────────────────────────────────────────────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├────────║────────┤ M ├─
               ║         └─────────────────┘ └─────────────────┘   │                                                                                         └───┘ └─────────────────┘ └─────────────────┘        ║        └───┘
               ║         ┌─────────────────┐ ┌─────────────────┐   │                                                                                                                                              ║        ┌───┐
q23 : ─────────╨─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╨────────┤ M ├─
                         └─────────────────┘ └─────────────────┘                                                                                                                                                           └───┘
T   : │        0        │         1         │         2         │  3  │         4         │         5         │  6  │         7         │         8         │  9  │        10         │        11         │      12       │ 13  │
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:909: UserWarning: Device does not support global phase; global phase of 4.71238898038469 will not be included in Braket circuit
  warnings.warn(
</pre></div></div>
</div>
<p>Here we see that the circuit uses a completely different set of qubits, and only four of them. To summarize the parameters that we’ve passed to <code class="docutils literal notranslate"><span class="pre">to_braket</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">target</span></code> tells the transpiler the device’s constraints, such as allowed gates and their error rates and qubit connectivity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qubit_labels</span></code> ensures that the labelling scheme of the Braket circuit matches that of the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">optimization_level</span></code> tells the Qiskit transpiler how much effort to spend optimizing the circuit</p></li>
</ul>
</section>
<section id="Transpiling-Braket-circuits">
<h2>Transpiling Braket circuits<a class="headerlink" href="#Transpiling-Braket-circuits" title="Link to this heading">¶</a></h2>
<p>In addition to transpiling Qiskit circuits, we can also transpile Braket circuits. Here, we will define the same GHZ state as we did above, but using a Braket circuit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ghz</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Circuit</span><span class="p">:</span>
    <span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">circuit</span>


<span class="n">circuit</span> <span class="o">=</span> <span class="n">ghz</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T  : │  0  │  1  │  2  │  3  │
      ┌───┐
q0 : ─┤ H ├───●───────────────
      └───┘   │
            ┌─┴─┐
q1 : ───────┤ X ├───●─────────
            └───┘   │
                  ┌─┴─┐
q2 : ─────────────┤ X ├───●───
                  └───┘   │
                        ┌─┴─┐
q3 : ───────────────────┤ X ├─
                        └───┘
T  : │  0  │  1  │  2  │  3  │
</pre></div></div>
</div>
<p>We see that calling <code class="docutils literal notranslate"><span class="pre">to_braket</span></code> on this circuit with the same target, qubit labels and optimization level results in a circuit identical to the one above:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">qubit_labels</span><span class="o">=</span><span class="n">qubit_labels</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T   : │        0        │         1         │         2         │  3  │         4         │         5         │  6  │         7         │         8         │  9  │        10         │        11         │      12       │ 13  │
                         ┌─────────────────┐ ┌─────────────────┐ ┌───┐ ┌─────────────────┐ ┌─────────────────┐                                                                                                             ┌───┐
q15 : ───StartVerbatim───┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├─┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●───────────────────────────────────────────────────────────────────────────────────────────EndVerbatim───┤ M ├─
               ║         └─────────────────┘ └─────────────────┘ └─┬─┘ └─────────────────┘ └─────────────────┘   │                                                                                                ║        └───┘
               ║         ┌─────────────────┐ ┌─────────────────┐   │                                           ┌─┴─┐ ┌─────────────────┐ ┌─────────────────┐                                                      ║        ┌───┐
q16 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───┼───────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●──────────────────────────────────────────────────║────────┤ M ├─
               ║         └─────────────────┘ └─────────────────┘   │                                           └───┘ └─────────────────┘ └─────────────────┘   │                                                  ║        └───┘
               ║         ┌─────────────────┐ ┌─────────────────┐   │                                                                                         ┌─┴─┐ ┌─────────────────┐ ┌─────────────────┐        ║        ┌───┐
q17 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───┼─────────────────────────────────────────────────────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├────────║────────┤ M ├─
               ║         └─────────────────┘ └─────────────────┘   │                                                                                         └───┘ └─────────────────┘ └─────────────────┘        ║        └───┘
               ║         ┌─────────────────┐ ┌─────────────────┐   │                                                                                                                                              ║        ┌───┐
q23 : ─────────╨─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╨────────┤ M ├─
                         └─────────────────┘ └─────────────────┘                                                                                                                                                           └───┘
T   : │        0        │         1         │         2         │  3  │         4         │         5         │  6  │         7         │         8         │  9  │        10         │        11         │      12       │ 13  │
</pre></div></div>
</div>
</section>
<section id="Transpiling-OpenQASM-3">
<h2>Transpiling OpenQASM 3<a class="headerlink" href="#Transpiling-OpenQASM-3" title="Link to this heading">¶</a></h2>
<p>In addition to Qiskit and Braket circuits, we can compile any static <a class="reference external" href="https://openqasm.com/">OpenQASM 3</a> programs (i.e. non-dynamic circuits). In this first example, we have a program with a custom gate definition, as well as control, inverse and power modifiers.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qasm_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    qubit[3] q;</span>

<span class="s2">    gate majority a, b, c {</span>
<span class="s2">        // set c to the majority of {a, b, c}</span>
<span class="s2">        ctrl @ x c, b;</span>
<span class="s2">        ctrl @ x c, a;</span>
<span class="s2">        ctrl(2) @ x a, b, c;</span>
<span class="s2">    }</span>

<span class="s2">    pow(0.5) @ x q[0:1];     // sqrt x</span>
<span class="s2">    inv @ v q[1];          // inv of (sqrt x)</span>
<span class="s2">    // this should flip q[2] to 1</span>
<span class="s2">    majority q[0], q[1], q[2];</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">qasm_string</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">qubit_labels</span><span class="o">=</span><span class="n">qubit_labels</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
This program uses OpenQASM language features that may not be supported on QPUs or on-demand simulators.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T   : │        0        │          1          │         2          │  3  │         4         │          5          │         6         │  7  │          8          │         9         │ 10  │         11         │         12         │ 13  │         14          │         15         │ 16  │         17         │         18         │        19         │ 20  │        21         │ 22  │ 23  │         24          │         25         │ 26  │        27         │        28         │      29       │
                                                                                              ┌───────────────────┐ ┌─────────────────┐ ┌───┐ ┌───────────────────┐ ┌─────────────────┐ ┌───┐ ┌──────────────────┐ ┌──────────────────┐ ┌───┐ ┌───────────────────┐ ┌─────────────────┐  ┌───┐ ┌──────────────────┐ ┌──────────────────┐
q48 : ───StartVerbatim────────────────────────────────────────────────●────────────●──────────┤ PRx(-3.14, -3.14) ├─┤ PRx(3.14, 0.00) ├─┤ Z ├─┤ PRx(-2.36, -3.14) ├─┤ PRx(3.14, 0.00) ├─┤ Z ├─┤ PRx(-2.36, 0.00) ├─┤ PRx(3.14, -3.14) ├─┤ Z ├─┤ PRx(-2.36, -3.14) ├─┤ PRx(3.14, 0.00) ├──┤ Z ├─┤ PRx(-2.36, 0.00) ├─┤ PRx(3.14, -3.14) ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────EndVerbatim───
               ║                                                      │            │          └───────────────────┘ └─────────────────┘ └─┬─┘ └───────────────────┘ └─────────────────┘ └─┬─┘ └──────────────────┘ └──────────────────┘ └─┬─┘ └───────────────────┘ └─────────────────┘  └─┬─┘ └──────────────────┘ └──────────────────┘                                                                                                                                                           ║
               ║         ┌───────────────────┐ ┌─────────────────┐    │          ┌─┴─┐         ┌─────────────────┐  ┌─────────────────┐   │                                               │                                               │                                                │   ┌─────────────────┐         ┌───┐         ┌─────────────────┐ ┌───┐ ┌─────────────────┐ ┌───┐                                                                                                       ║
q49 : ─────────║─────────┤ PRx(-1.57, -1.57) ├─┤ PRx(3.14, 0.79) ├────┼──────────┤ Z ├─────────┤ PRx(1.57, 1.57) ├──┤ PRx(3.14, 0.00) ├───┼───────────────────────────────────────────────●───────────────────────────────────────────────┼────────────────────────────────────────────────●───┤ PRx(1.57, 0.00) ├─────────┤ Z ├─────────┤ PRx(1.57, 0.00) ├─┤ Z ├─┤ PRx(1.57, 0.00) ├─┤ Z ├───────────────────────────────────────────────────────────────────────────────────────────────────────║────────
               ║         └───────────────────┘ └─────────────────┘    │          └───┘         └─────────────────┘  └─────────────────┘   │                                                                                               │                                                    └─────────────────┘         └─┬─┘         └─────────────────┘ └─┬─┘ └─────────────────┘ └─┬─┘                                                                                                       ║
               ║         ┌───────────────────┐ ┌──────────────────┐ ┌─┴─┐ ┌─────────────────┐  ┌─────────────────┐                        │                                                                                               │   ┌───────────────────┐ ┌──────────────────┐                                     │                                 │                         │   ┌───┐ ┌───────────────────┐ ┌─────────────────┐  ┌───┐ ┌─────────────────┐ ┌─────────────────┐        ║
q52 : ─────────║─────────┤ PRx(-1.57, -1.57) ├─┤ PRx(3.14, -0.00) ├─┤ Z ├─┤ PRx(1.57, 1.57) ├──┤ PRx(3.14, 0.00) ├────────────────────────●───────────────────────────────────────────────────────────────────────────────────────────────●───┤ PRx(-1.57, -2.36) ├─┤ PRx(3.14, -0.39) ├─────────────────────────────────────┼─────────────────────────────────┼─────────────────────────┼───┤ Z ├─┤ PRx(-2.36, -3.14) ├─┤ PRx(3.14, 0.00) ├──┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├────────║────────
               ║         └───────────────────┘ └──────────────────┘ └───┘ └─────────────────┘  └─────────────────┘                                                                                                                            └───────────────────┘ └──────────────────┘                                     │                                 │                         │   └─┬─┘ └───────────────────┘ └─────────────────┘  └─┬─┘ └─────────────────┘ └─────────────────┘        ║
               ║          ┌─────────────────┐                                                                                                                                                                                                                                                                                │           ┌─────────────────┐   │   ┌─────────────────┐   │     │   ┌───────────────────┐ ┌──────────────────┐   │                                                  ║
q53 : ─────────╨──────────┤ PRx(1.57, 0.00) ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────●───────────┤ PRx(1.57, 0.00) ├───●───┤ PRx(1.57, 0.00) ├───●─────●───┤ PRx(-3.14, -1.96) ├─┤ PRx(3.14, -1.57) ├───●──────────────────────────────────────────────────╨────────
                          └─────────────────┘                                                                                                                                                                                                                                                                                            └─────────────────┘       └─────────────────┘             └───────────────────┘ └──────────────────┘
T   : │        0        │          1          │         2          │  3  │         4         │          5          │         6         │  7  │          8          │         9         │ 10  │         11         │         12         │ 13  │         14          │         15         │ 16  │         17         │         18         │        19         │ 20  │        21         │ 22  │ 23  │         24          │         25         │ 26  │        27         │        28         │      29       │
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:909: UserWarning: Device does not support global phase; global phase of 1.1780972450961826 will not be included in Braket circuit
  warnings.warn(
</pre></div></div>
</div>
<p>Next we create a program with a function definition, classical arithmetic, input parameters, and a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop. Since the input string is odd, we should expect the transpiled circuit to consist of a single <span class="math notranslate nohighlight">\(X\)</span> gate, or in Emerald’s native gateset, <span class="math notranslate nohighlight">\(PRx(\pi, 0)\)</span>. For a change, we’ll also convert the program to OpenQASM, thus demonstrating an OpenQASM-to-OpenQASM transpilation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qasm_program</span> <span class="o">=</span> <span class="n">Program</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        const int[8] n = 4;</span>
<span class="s2">        input bit[n] x;</span>

<span class="s2">        qubit q;</span>

<span class="s2">        def parity(bit[n] cin) -&gt; bit {</span>
<span class="s2">            bit c = false;</span>
<span class="s2">            for int[8] i in [0: n - 1] {</span>
<span class="s2">                c ^= cin[i];</span>
<span class="s2">            }</span>
<span class="s2">            return c;</span>
<span class="s2">        }</span>

<span class="s2">        if (parity(x)) {</span>
<span class="s2">            x q;</span>
<span class="s2">        } else {</span>
<span class="s2">            i q;</span>
<span class="s2">        }</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;1011&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">to_braket</span><span class="p">(</span><span class="n">qasm_program</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">qubit_labels</span><span class="o">=</span><span class="n">qubit_labels</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_ir</span><span class="p">(</span>
        <span class="n">IRType</span><span class="o">.</span><span class="n">OPENQASM</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
This program uses OpenQASM language features that may not be supported on QPUs or on-demand simulators.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
braketSchemaHeader=BraketSchemaHeader(name=&#39;braket.ir.openqasm.program&#39;, version=&#39;1&#39;) source=&#39;OPENQASM 3.0;\nbit[1] b;\n#pragma braket verbatim\nbox{\nprx(3.141592653589793, 0.0) $1;\n}\nb[0] = measure $1;&#39; inputs={}
</pre></div></div>
</div>
<p>Now, we put it all together by generating the GHZ state <em>directly in OpenQASM</em>, and use the inputs to define a four-qubit observable in binary symplectic form.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ghz_program</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Program</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Program</span><span class="p">(</span>
        <span class="n">source</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            int n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">;</span>
<span class="s2">            input bit[n] x;</span>
<span class="s2">            input bit[n] z;</span>
<span class="s2">            qubit[n] q;</span>

<span class="s2">            h q[0];</span>

<span class="s2">            for int i in [0: n - 2] </span><span class="se">{{</span>
<span class="s2">                ctrl @ x q[i], q[i + 1];</span>
<span class="s2">            </span><span class="se">}}</span>

<span class="s2">            def observable(bit[n] x, bit[n] z) </span><span class="se">{{</span>
<span class="s2">                for int i in [0: n - 1] </span><span class="se">{{</span>
<span class="s2">                    if (x[i]) </span><span class="se">{{</span>
<span class="s2">                        if (z[i]) </span><span class="se">{{</span>
<span class="s2">                            si q[i];</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                        h q[i];</span>
<span class="s2">                    </span><span class="se">}}</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">            </span><span class="se">}}</span>

<span class="s2">            observable(x, z);</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">z</span><span class="p">},</span>
    <span class="p">)</span>


<span class="n">ghz_4</span> <span class="o">=</span> <span class="n">ghz_program</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;0110&quot;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s2">&quot;0011&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The observables we passed are <span class="math notranslate nohighlight">\(I_0\)</span>, <span class="math notranslate nohighlight">\(X_1\)</span>, <span class="math notranslate nohighlight">\(Y_2\)</span>, and <span class="math notranslate nohighlight">\(Z_3\)</span>, which we can verify from the basis rotations of the translated circuit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">ghz_4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
This program uses OpenQASM language features that may not be supported on QPUs or on-demand simulators.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T  : │  0  │  1  │  2  │  3  │  4   │  5  │
      ┌───┐
q0 : ─┤ H ├───●────────────────────────────
      └───┘   │
            ┌─┴─┐       ┌───┐
q1 : ───────┤ X ├───●───┤ H ├──────────────
            └───┘   │   └───┘
                  ┌─┴─┐       ┌────┐ ┌───┐
q2 : ─────────────┤ X ├───●───┤ Si ├─┤ H ├─
                  └───┘   │   └────┘ └───┘
                        ┌─┴─┐
q3 : ───────────────────┤ X ├──────────────
                        └───┘
T  : │  0  │  1  │  2  │  3  │  4   │  5  │
</pre></div></div>
</div>
<p>Transpiling to an Emerald circuit:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">ghz_4</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">qubit_labels</span><span class="o">=</span><span class="n">qubit_labels</span><span class="p">,</span> <span class="n">optimization_level</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
This program uses OpenQASM language features that may not be supported on QPUs or on-demand simulators.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T   : │        0        │         1         │         2         │  3  │         4         │         5         │  6  │         7         │         8         │  9  │         10         │        11         │      12       │
                         ┌─────────────────┐ ┌─────────────────┐
q34 : ───StartVerbatim───┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────EndVerbatim───
               ║         └─────────────────┘ └─────────────────┘   │                                                                                                                                               ║
               ║         ┌─────────────────┐ ┌─────────────────┐ ┌─┴─┐ ┌─────────────────┐ ┌─────────────────┐       ┌─────────────────┐ ┌─────────────────┐                                                       ║
q42 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├─┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●───┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───────────────────────────────────────────────────────║────────
               ║         └─────────────────┘ └─────────────────┘ └───┘ └─────────────────┘ └─────────────────┘   │   └─────────────────┘ └─────────────────┘                                                       ║
               ║         ┌─────────────────┐ ┌─────────────────┐                                                 │                                           ┌───┐ ┌─────────────────┐  ┌─────────────────┐        ║
q47 : ─────────║─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├─────────────────────────────────────────────────┼───────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├──┤ PRx(3.14, 0.00) ├────────║────────
               ║         └─────────────────┘ └─────────────────┘                                                 │                                           └─┬─┘ └─────────────────┘  └─────────────────┘        ║
               ║         ┌─────────────────┐ ┌─────────────────┐                                               ┌─┴─┐ ┌─────────────────┐ ┌─────────────────┐   │   ┌──────────────────┐ ┌─────────────────┐        ║
q48 : ─────────╨─────────┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───────────────────────────────────────────────┤ Z ├─┤ PRx(1.57, 1.57) ├─┤ PRx(3.14, 0.00) ├───●───┤ PRx(-1.57, 0.00) ├─┤ PRx(3.14, 0.79) ├────────╨────────
                         └─────────────────┘ └─────────────────┘                                               └───┘ └─────────────────┘ └─────────────────┘       └──────────────────┘ └─────────────────┘
T   : │        0        │         1         │         2         │  3  │         4         │         5         │  6  │         7         │         8         │  9  │         10         │        11         │      12       │
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:909: UserWarning: Device does not support global phase; global phase of 0.7853981633974474 will not be included in Braket circuit
  warnings.warn(
</pre></div></div>
</div>
<p>For more examples of the kinds of programs we can transpile, see the amazon-braket-examples notebook on <a class="reference external" href="https://github.com/amazon-braket/amazon-braket-examples/blob/main/examples/braket_features/Simulating_Advanced_OpenQASM_Programs_with_the_Local_Simulator.ipynb">simulating advanced OpenQASM programs</a>.</p>
<p>So far, we’ve been transpiling circuits with Qiskit’s default transpilation steps. However, if we want finer-grained control of the transpiler, we can also use a custom <a class="reference external" href="https://quantum.cloud.ibm.com/docs/en/guides/transpile-with-pass-managers">pass manager</a> instead of a device target (of course, the circuit below will not run on Emerald because we’ve used non-native gates).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">basis_gates</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rx&quot;</span><span class="p">,</span> <span class="s2">&quot;ry&quot;</span><span class="p">,</span> <span class="s2">&quot;rxx&quot;</span><span class="p">]</span>
<span class="n">pass_manager</span> <span class="o">=</span> <span class="n">PassManager</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Collect2qBlocks</span><span class="p">(),</span>
        <span class="n">ConsolidateBlocks</span><span class="p">(</span><span class="n">basis_gates</span><span class="o">=</span><span class="n">basis_gates</span><span class="p">),</span>
        <span class="n">UnitarySynthesis</span><span class="p">(</span><span class="n">basis_gates</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">to_braket</span><span class="p">(</span><span class="n">ghz_4</span><span class="p">,</span> <span class="n">pass_manager</span><span class="o">=</span><span class="n">pass_manager</span><span class="p">,</span> <span class="n">qubit_labels</span><span class="o">=</span><span class="n">qubit_labels</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
This program uses OpenQASM language features that may not be supported on QPUs or on-demand simulators.
/Users/caw/Documents/GitHub/qiskit-braket-provider/qiskit_braket_provider/providers/adapter.py:909: UserWarning: Device does not support global phase; global phase of 4.712388980384691 will not be included in Braket circuit
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
T  : │        0        │      1      │      2      │      3      │      4      │      5      │      6      │     7      │     8      │     9      │     10     │     11     │     12      │     13      │     14      │     15      │     16     │     17     │     18      │     19      │     20      │     21     │      22       │
                        ┌───────────┐ ┌──────────┐  ┌──────────┐                ┌───────────┐ ┌──────────┐  ┌──────────┐ ┌──────────┐
q1 : ───StartVerbatim───┤ Rx(-0.79) ├─┤ Ry(3.14) ├──┤ Rx(1.57) ├────────────────┤ XX(-1.57) ├─┤ Rx(1.57) ├──┤ Rx(0.79) ├─┤ Ry(1.57) ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────EndVerbatim───
              ║         └───────────┘ └──────────┘  └──────────┘                └─────┬─────┘ └──────────┘  └──────────┘ └──────────┘                                                                                                                                                                                        ║
              ║         ┌──────────┐  ┌──────────┐  ┌───────────┐ ┌───────────┐ ┌─────┴─────┐ ┌───────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌───────────┐ ┌──────────┐  ┌───────────┐                                                                                                       ║
q2 : ─────────║─────────┤ Rx(2.36) ├──┤ Ry(3.14) ├──┤ Ry(-3.14) ├─┤ Rx(-1.57) ├─┤ XX(-1.57) ├─┤ Ry(-3.14) ├─┤ Rx(1.57) ├─┤ Rx(0.79) ├─┤ Ry(3.14) ├─┤ Ry(1.57) ├─┤ Rx(1.57) ├─┤ XX(-1.57) ├─┤ Rx(1.57) ├──┤ Rx(-1.57) ├───────────────────────────────────────────────────────────────────────────────────────────────────────║────────
              ║         └──────────┘  └──────────┘  └───────────┘ └───────────┘ └───────────┘ └───────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘ └─────┬─────┘ └──────────┘  └───────────┘                                                                                                       ║
              ║         ┌───────────┐ ┌───────────┐ ┌───────────┐                                                                                                            ┌─────┴─────┐ ┌───────────┐ ┌──────────┐  ┌───────────┐ ┌──────────┐ ┌──────────┐ ┌───────────┐ ┌──────────┐  ┌───────────┐                     ║
q3 : ─────────║─────────┤ Rx(-2.36) ├─┤ Ry(-3.14) ├─┤ Rx(-1.57) ├────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ XX(-1.57) ├─┤ Ry(-3.14) ├─┤ Rx(1.57) ├──┤ Rx(-2.36) ├─┤ Ry(1.57) ├─┤ Rx(1.57) ├─┤ XX(-1.57) ├─┤ Rx(1.57) ├──┤ Rx(-3.14) ├─────────────────────║────────
              ║         └───────────┘ └───────────┘ └───────────┘                                                                                                            └───────────┘ └───────────┘ └──────────┘  └───────────┘ └──────────┘ └──────────┘ └─────┬─────┘ └──────────┘  └───────────┘                     ║
              ║         ┌──────────┐  ┌───────────┐ ┌───────────┐                                                                                                                                                                                              ┌─────┴─────┐ ┌───────────┐ ┌──────────┐  ┌──────────┐        ║
q4 : ─────────╨─────────┤ Rx(0.55) ├──┤ Ry(-3.14) ├─┤ Rx(-1.57) ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ XX(-1.57) ├─┤ Ry(-3.14) ├─┤ Rx(1.57) ├──┤ Rx(1.02) ├────────╨────────
                        └──────────┘  └───────────┘ └───────────┘                                                                                                                                                                                              └───────────┘ └───────────┘ └──────────┘  └──────────┘
T  : │        0        │      1      │      2      │      3      │      4      │      5      │      6      │     7      │     8      │     9      │     10     │     11     │     12      │     13      │     14      │     15      │     16     │     17     │     18      │     19      │     20      │     21     │      22       │
</pre></div></div>
</div>
<p>As was the case with using a target, the output Braket circuit is wrapped in a verbatim box so no further modifications are made.</p>
</section>
<section id="Running-on-a-BraketBackend">
<h2>Running on a BraketBackend<a class="headerlink" href="#Running-on-a-BraketBackend" title="Link to this heading">¶</a></h2>
<p>Calling <code class="docutils literal notranslate"><span class="pre">to_braket</span></code> produces a Braket circuit, which can works with the Braket <code class="docutils literal notranslate"><span class="pre">Device</span></code> class, but not the Qiskit <code class="docutils literal notranslate"><span class="pre">Backend</span></code> class. To run a circuit on a <code class="docutils literal notranslate"><span class="pre">BraketAwsBackend</span></code> with native transpilation, we simply need to call <code class="docutils literal notranslate"><span class="pre">Backend.run</span></code> with <code class="docutils literal notranslate"><span class="pre">native=True</span></code> (<code class="docutils literal notranslate"><span class="pre">BraketAwsBackend</span></code> supplies the target and qubit labels) and optionally an optimization level. Alternatively, we can supply a pass manager instead of the <code class="docutils literal notranslate"><span class="pre">native</span></code> keyword and optimization level.</p>
<p>Uncomment the cells below to try this out; note that running these circuits will incur AWS charges.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># task = backend.run(to_qiskit(ghz_4), shots=1000, native=True, optimization_level=1)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from qiskit.transpiler import generate_preset_pass_manager</span>
<span class="c1"># task = backend.run(to_qiskit(ghz_4), shots=1000, pass_manager=generate_preset_pass_manager(3, backend))</span>
</pre></div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        <div class="related-pages">
          <a class="next-page" href="6_tutorial_primitives.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Braket-native primitives</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="4_tutorial_native_programming.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Native Programming</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Transpiling circuits and programs to Braket</a><ul>
<li><a class="reference internal" href="#Transpiling-Qiskit-circuits">Transpiling Qiskit circuits</a></li>
<li><a class="reference internal" href="#Transpiling-Braket-circuits">Transpiling Braket circuits</a></li>
<li><a class="reference internal" href="#Transpiling-OpenQASM-3">Transpiling OpenQASM 3</a></li>
<li><a class="reference internal" href="#Running-on-a-BraketBackend">Running on a BraketBackend</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=39bb1c6d"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/qiskit-sphinx-theme.js?v=4d77b8ca"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>